{"ast":null,"code":"import { defineComponent, getCurrentInstance, watch, onUnmounted, onUpdated, h } from 'vue';\nimport { removeClass, addClass } from '../../../../utils/dom.mjs';\nimport isServer from '../../../../utils/isServer.mjs';\nimport { hColgroup } from '../h-helper.mjs';\nimport useLayoutObserver from '../layout-observer.mjs';\nimport { removePopper } from '../util.mjs';\nimport useRender from './render-helper.mjs';\nimport defaultProps from './defaults.mjs';\nvar TableBody = defineComponent({\n  name: \"ElTableBody\",\n  props: defaultProps,\n  setup(props) {\n    const instance = getCurrentInstance();\n    const parent = instance.parent;\n    const {\n      wrappedRowRender,\n      tooltipContent,\n      tooltipTrigger\n    } = useRender(props);\n    const {\n      onColumnsChange,\n      onScrollableChange\n    } = useLayoutObserver(parent);\n    watch(props.store.states.hoverRow, (newVal, oldVal) => {\n      if (!props.store.states.isComplex.value || isServer) return;\n      let raf = window.requestAnimationFrame;\n      if (!raf) {\n        raf = fn => window.setTimeout(fn, 16);\n      }\n      raf(() => {\n        const rows = instance.vnode.el.querySelectorAll(\".el-table__row\");\n        const oldRow = rows[oldVal];\n        const newRow = rows[newVal];\n        if (oldRow) {\n          removeClass(oldRow, \"hover-row\");\n        }\n        if (newRow) {\n          addClass(newRow, \"hover-row\");\n        }\n      });\n    });\n    onUnmounted(() => {\n      var _a;\n      (_a = removePopper) == null ? void 0 : _a();\n    });\n    onUpdated(() => {\n      var _a;\n      (_a = removePopper) == null ? void 0 : _a();\n    });\n    return {\n      onColumnsChange,\n      onScrollableChange,\n      wrappedRowRender,\n      tooltipContent,\n      tooltipTrigger\n    };\n  },\n  render() {\n    const data = this.store.states.data.value || [];\n    return h(\"table\", {\n      class: \"el-table__body\",\n      cellspacing: \"0\",\n      cellpadding: \"0\",\n      border: \"0\"\n    }, [hColgroup(this.store.states.columns.value), h(\"tbody\", {}, [data.reduce((acc, row) => {\n      return acc.concat(this.wrappedRowRender(row, acc.length));\n    }, [])])]);\n  }\n});\nexport { TableBody as default };","map":{"version":3,"names":["TableBody","defineComponent","name","props","defaultProps","setup","instance","getCurrentInstance","parent","wrappedRowRender","tooltipContent","tooltipTrigger","useRender","onColumnsChange","onScrollableChange","useLayoutObserver","watch","store","states","hoverRow","newVal","oldVal","isComplex","value","isServer","raf","window","requestAnimationFrame","fn","setTimeout","rows","vnode","el","querySelectorAll","oldRow","newRow","removeClass","addClass","onUnmounted","_a","removePopper","onUpdated","render","data","h","class","cellspacing","cellpadding","border","hColgroup","columns","reduce","acc","row","concat","length"],"sources":["../../../../../../../packages/components/table/src/table-body/index.ts"],"sourcesContent":["import {\n  defineComponent,\n  getCurrentInstance,\n  h,\n  watch,\n  onUnmounted,\n  onUpdated,\n} from 'vue'\nimport { addClass, removeClass } from '@element-plus/utils/dom'\nimport isServer from '@element-plus/utils/isServer'\nimport { hColgroup } from '../h-helper'\nimport useLayoutObserver from '../layout-observer'\nimport { removePopper } from '../util'\nimport useRender from './render-helper'\nimport defaultProps from './defaults'\n\nimport type { VNode } from 'vue'\nimport type { DefaultRow, Table } from '../table/defaults'\n\nexport default defineComponent({\n  name: 'ElTableBody',\n  props: defaultProps,\n  setup(props) {\n    const instance = getCurrentInstance()\n    const parent = instance.parent as Table<DefaultRow>\n\n    const { wrappedRowRender, tooltipContent, tooltipTrigger } =\n      useRender(props)\n    const { onColumnsChange, onScrollableChange } = useLayoutObserver(parent)\n\n    watch(props.store.states.hoverRow, (newVal: any, oldVal: any) => {\n      if (!props.store.states.isComplex.value || isServer) return\n      let raf = window.requestAnimationFrame\n      if (!raf) {\n        raf = (fn) => window.setTimeout(fn, 16)\n      }\n      raf(() => {\n        const rows = instance.vnode.el.querySelectorAll('.el-table__row')\n        const oldRow = rows[oldVal]\n        const newRow = rows[newVal]\n        if (oldRow) {\n          removeClass(oldRow, 'hover-row')\n        }\n        if (newRow) {\n          addClass(newRow, 'hover-row')\n        }\n      })\n    })\n\n    onUnmounted(() => {\n      removePopper?.()\n    })\n    onUpdated(() => {\n      removePopper?.()\n    })\n\n    return {\n      onColumnsChange,\n      onScrollableChange,\n      wrappedRowRender,\n      tooltipContent,\n      tooltipTrigger,\n    }\n  },\n  render() {\n    const data = this.store.states.data.value || []\n    return h(\n      'table',\n      {\n        class: 'el-table__body',\n        cellspacing: '0',\n        cellpadding: '0',\n        border: '0',\n      },\n      [\n        hColgroup(this.store.states.columns.value),\n        h('tbody', {}, [\n          data.reduce((acc: VNode[], row) => {\n            return acc.concat(this.wrappedRowRender(row, acc.length))\n          }, []),\n        ]),\n      ]\n    )\n  },\n})\n"],"mappings":";;;;;;;;AAmBA,IAAAA,SAAA,GAAeC,eAAA,CAAgB;EAC7BC,IAAA,EAAM;EACNC,KAAA,EAAOC,YAAA;EACPC,MAAMF,KAAA,EAAO;IACX,MAAMG,QAAA,GAAWC,kBAAA;IACjB,MAAMC,MAAA,GAASF,QAAA,CAASE,MAAA;IAExB,MAAM;MAAEC,gBAAA;MAAkBC,cAAA;MAAgBC;IAAA,IACxCC,SAAA,CAAUT,KAAA;IACZ,MAAM;MAAEU,eAAA;MAAiBC;IAAA,IAAuBC,iBAAA,CAAkBP,MAAA;IAElEQ,KAAA,CAAMb,KAAA,CAAMc,KAAA,CAAMC,MAAA,CAAOC,QAAA,EAAU,CAACC,MAAA,EAAaC,MAAA,KAAgB;MAC/D,IAAI,CAAClB,KAAA,CAAMc,KAAA,CAAMC,MAAA,CAAOI,SAAA,CAAUC,KAAA,IAASC,QAAA,EAAU;MACrD,IAAIC,GAAA,GAAMC,MAAA,CAAOC,qBAAA;MACjB,IAAI,CAACF,GAAA,EAAK;QACRA,GAAA,GAAOG,EAAA,IAAOF,MAAA,CAAOG,UAAA,CAAWD,EAAA,EAAI;MAAA;MAEtCH,GAAA,CAAI,MAAM;QACR,MAAMK,IAAA,GAAOxB,QAAA,CAASyB,KAAA,CAAMC,EAAA,CAAGC,gBAAA,CAAiB;QAChD,MAAMC,MAAA,GAASJ,IAAA,CAAKT,MAAA;QACpB,MAAMc,MAAA,GAASL,IAAA,CAAKV,MAAA;QACpB,IAAIc,MAAA,EAAQ;UACVE,WAAA,CAAYF,MAAA,EAAQ;QAAA;QAEtB,IAAIC,MAAA,EAAQ;UACVE,QAAA,CAASF,MAAA,EAAQ;QAAA;MAAA;IAAA;IAKvBG,WAAA,CAAY,MAAM;MAjDtB,IAAAC,EAAA;MAkDM,CAAAA,EAAA,GAAAC,YAAA,qBAAAD,EAAA;IAAA;IAEFE,SAAA,CAAU,MAAM;MApDpB,IAAAF,EAAA;MAqDM,CAAAA,EAAA,GAAAC,YAAA,qBAAAD,EAAA;IAAA;IAGF,OAAO;MACL1B,eAAA;MACAC,kBAAA;MACAL,gBAAA;MACAC,cAAA;MACAC;IAAA;EAAA;EAGJ+B,OAAA,EAAS;IACP,MAAMC,IAAA,GAAO,KAAK1B,KAAA,CAAMC,MAAA,CAAOyB,IAAA,CAAKpB,KAAA,IAAS;IAC7C,OAAOqB,CAAA,CACL,SACA;MACEC,KAAA,EAAO;MACPC,WAAA,EAAa;MACbC,WAAA,EAAa;MACbC,MAAA,EAAQ;IAAA,GAEV,CACEC,SAAA,CAAU,KAAKhC,KAAA,CAAMC,MAAA,CAAOgC,OAAA,CAAQ3B,KAAA,GACpCqB,CAAA,CAAE,SAAS,IAAI,CACbD,IAAA,CAAKQ,MAAA,CAAO,CAACC,GAAA,EAAcC,GAAA,KAAQ;MACjC,OAAOD,GAAA,CAAIE,MAAA,CAAO,KAAK7C,gBAAA,CAAiB4C,GAAA,EAAKD,GAAA,CAAIG,MAAA;IAAA,GAChD;EAAA;AAAA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}