{"ast":null,"code":"// @ is an alias to /src\nimport request from \"../utils/request\";\nimport { ElMessage } from \"element-plus\";\nexport default {\n  created() {\n    this.load();\n    let userStr = sessionStorage.getItem(\"user\") || \"{}\";\n    this.user = JSON.parse(userStr);\n  },\n  name: 'LUser',\n  methods: {\n    handleSelectionChange(val) {\n      this.ids = val.map(v => v.id);\n    },\n    deleteBatch() {\n      if (!this.ids.length) {\n        ElMessage.warning(\"Please choose one at least!\");\n        return;\n      }\n      //  一个小优化，直接发送这个数组，而不是一个一个的提交删除\n      request.post(\"http://localhost:8181/user/deleteBatch\", this.ids).then(res => {\n        if (res.code === '0') {\n          ElMessage.success(\"Successfully batch delete!\");\n          this.load();\n        } else {\n          ElMessage.error(res.msg);\n        }\n      });\n    },\n    load() {\n      request.get(\"http://localhost:8181/user/usersearch\", {\n        params: {\n          pageNum: this.currentPage,\n          pageSize: this.pageSize,\n          search1: this.search1,\n          search2: this.search2,\n          search3: this.search3,\n          search4: this.search4\n        }\n      }).then(res => {\n        console.log(res);\n        this.tableData = res.data.records;\n        this.total = res.data.total;\n      });\n    },\n    clear() {\n      this.search1 = \"\";\n      this.search2 = \"\";\n      this.search3 = \"\";\n      this.load();\n    },\n    handleDelete(id) {\n      request.delete(\"http://localhost:8181/user/\" + id).then(res => {\n        console.log(res);\n        if (res.code == 0) {\n          ElMessage.success(\"Successfully delete!\");\n        } else ElMessage.error(res.msg);\n        this.load();\n      });\n    },\n    add() {\n      this.dialogVisible = true;\n      this.form = {};\n    },\n    save() {\n      if (this.form.id) {\n        request.put(\"http://localhost:8181/user\", this.form).then(res => {\n          console.log(res);\n          if (res.code == 0) {\n            ElMessage({\n              message: 'Successfully Update!',\n              type: 'success'\n            });\n          } else {\n            ElMessage.error(res.msg);\n          }\n          this.load(); //不知道为啥，更新必须要放在这里面\n          this.dialogVisible = false;\n        });\n      } else {\n        request.post(\"http://localhost:8181/user\", this.form).then(res => {\n          console.log(res);\n          if (res.code == 0) {\n            ElMessage.success('Successfully Save!');\n          } else {\n            ElMessage.error(res.msg);\n          }\n          this.load();\n          this.dialogVisible = false;\n        });\n      }\n    },\n    handleEdit(row) {\n      this.form = JSON.parse(JSON.stringify(row));\n      this.dialogVisible = true;\n    },\n    handleSizeChange(pageSize) {\n      this.pageSize = pageSize;\n      this.load();\n    },\n    handleCurrentChange(pageNum) {\n      this.pageNum = pageNum;\n      this.load();\n    }\n  },\n  data() {\n    return {\n      form: {},\n      dialogVisible: false,\n      search1: '',\n      search2: '',\n      search3: '',\n      search4: '',\n      total: 10,\n      currentPage: 1,\n      pageSize: 10,\n      tableData: [],\n      user: {},\n      ids: []\n    };\n  }\n};","map":{"version":3,"names":["request","ElMessage","created","load","userStr","sessionStorage","getItem","user","JSON","parse","name","methods","handleSelectionChange","val","ids","map","v","id","deleteBatch","length","warning","post","then","res","code","success","error","msg","get","params","pageNum","currentPage","pageSize","search1","search2","search3","search4","console","log","tableData","data","records","total","clear","handleDelete","delete","add","dialogVisible","form","save","put","message","type","handleEdit","row","stringify","handleSizeChange","handleCurrentChange"],"sources":["G:\\SPM-A5-Library\\libraryFront\\src\\views\\User.vue"],"sourcesContent":["<template>\r\n  <div class=\"home\" style =\"padding: 10px\">\r\n<!-- 按钮-->\r\n<!-- 搜索-->\r\n    <div style=\"margin: 10px 0;\">\r\n      <el-form inline=\"true\" size=\"small\">\r\n        <el-form-item label=\"ISBN\" >\r\n      <el-input v-model=\"search1\" placeholder=\"Please enter ISBN\"  clearable>\r\n        <template #prefix><el-icon class=\"el-input__icon\"><search/></el-icon></template>\r\n      </el-input>\r\n          </el-form-item >\r\n        <el-form-item label=\"Name\" >\r\n          <el-input v-model=\"search2\" placeholder=\"Please enter name\"  clearable>\r\n            <template #prefix><el-icon class=\"el-input__icon\"><search /></el-icon></template>\r\n          </el-input>\r\n        </el-form-item >\r\n        <el-form-item label=\"Phone Number\" >\r\n          <el-input v-model=\"search3\" placeholder=\"Please enter phone number\"  clearable>\r\n            <template #prefix><el-icon class=\"el-input__icon\"><search /></el-icon></template>\r\n          </el-input>\r\n        </el-form-item >\r\n        <el-form-item label=\"Address\" >\r\n          <el-input v-model=\"search4\" placeholder=\"Please enter address\"  clearable>\r\n            <template #prefix><el-icon class=\"el-input__icon\"><search /></el-icon></template>\r\n          </el-input>\r\n        </el-form-item >\r\n        <el-form-item>\r\n      <el-button type=\"primary\" style=\"margin-left: 1%\" @click=\"load\" size=\"mini\">Search</el-button>\r\n        </el-form-item>\r\n        <el-form-item>\r\n          <el-button size=\"mini\"  type=\"danger\" @click=\"clear\">Reset</el-button>\r\n        </el-form-item>\r\n      </el-form>\r\n    </div>\r\n    <!-- 按钮-->\r\n    <div style=\"margin: 10px 0;\" >\r\n      <el-popconfirm title=\"Please confirm to delete\" @confirm=\"deleteBatch\" v-if=\"user.role == 1\">\r\n        <template #reference>\r\n          <el-button type=\"danger\" size=\"mini\" >Batch Delete</el-button>\r\n        </template>\r\n      </el-popconfirm>\r\n    </div>\r\n<!-- 数据字段-->\r\n    <el-table :data=\"tableData\" stripe border=\"true\"  @selection-change=\"handleSelectionChange\" >\r\n      <el-table-column v-if=\"user.role ==1 \"\r\n                       type=\"selection\"\r\n                       width=\"55\">\r\n      </el-table-column>\r\n      <el-table-column prop=\"id\" label=\"ISBN\" sortable />\r\n      <el-table-column prop=\"username\" label=\"Username\" />\r\n      <el-table-column prop=\"nickName\" label=\"Name\" />\r\n      <el-table-column prop=\"phone\" label=\"Phone Number\" />\r\n      <el-table-column prop=\"sex\" label=\"Gender\" />\r\n      <el-table-column prop=\"address\" label=\"Address\" />\r\n      <el-table-column fixed=\"right\" label=\"Options\" >\r\n        <template v-slot=\"scope\">\r\n          <el-button  size=\"mini\" @click =\"handleEdit(scope.row)\">Edit</el-button>\r\n          <el-popconfirm title=\"Please confirm to delete\" @confirm=\"handleDelete(scope.row.id)\">\r\n            <template #reference>\r\n              <el-button type=\"danger\" size=\"mini\" >Delete</el-button>\r\n            </template>\r\n          </el-popconfirm>\r\n        </template>\r\n      </el-table-column>\r\n    </el-table>\r\n<!--    分页-->\r\n    <div style=\"margin: 10px 0\">\r\n      <el-pagination\r\n          v-model:currentPage=\"currentPage\"\r\n          :page-sizes=\"[5, 10, 20]\"\r\n          :page-size=\"pageSize\"\r\n          layout=\"total, sizes, prev, pager, next, jumper\"\r\n          :total=\"total\"\r\n          @size-change=\"handleSizeChange\"\r\n          @current-change=\"handleCurrentChange\"\r\n      >\r\n      </el-pagination>\r\n\r\n      <el-dialog v-model=\"dialogVisible\" title=\"Edit Patron Information\" width=\"30%\">\r\n        <el-form :model=\"form\" label-width=\"120px\">\r\n          <el-form-item label=\"Username\">\r\n            <el-input style=\"width: 80%\" v-model=\"form.username\"></el-input>\r\n          </el-form-item>\r\n          <el-form-item label=\"Name\">\r\n            <el-input style=\"width: 80%\" v-model=\"form.nickName\"></el-input>\r\n          </el-form-item>\r\n          <el-form-item label=\"Phone Number\">\r\n            <el-input style=\"width: 80%\" v-model=\"form.phone\"></el-input>\r\n          </el-form-item>\r\n          <el-form-item label=\"Gender\">\r\n            <div>\r\n              <el-radio v-model=\"form.sex\" label=\"Male\">Male</el-radio>\r\n              <el-radio v-model=\"form.sex\" label=\"Female\">Female</el-radio>\r\n            </div>\r\n          </el-form-item>\r\n          <el-form-item label=\"Address\">\r\n            <el-input type=\"textarea\" style=\"width: 80%\" v-model=\"form.address\"></el-input>\r\n          </el-form-item>\r\n        </el-form>\r\n        <template #footer>\r\n      <span class=\"dialog-footer\">\r\n        <el-button @click=\"dialogVisible = false\">Cancel</el-button>\r\n        <el-button type=\"primary\" @click=\"save\">Save</el-button>\r\n      </span>\r\n        </template>\r\n      </el-dialog>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\n// @ is an alias to /src\r\nimport request from \"../utils/request\";\r\nimport {ElMessage} from \"element-plus\";\r\n\r\nexport default {\r\n  created(){\r\n    this.load()\r\n    let userStr = sessionStorage.getItem(\"user\") ||\"{}\"\r\n    this.user = JSON.parse(userStr)\r\n  },\r\n  name: 'LUser',\r\n  methods: {\r\n    handleSelectionChange(val){\r\n      this.ids = val.map(v => v.id)\r\n    },\r\n    deleteBatch(){\r\n      if (!this.ids.length) {\r\n        ElMessage.warning(\"Please choose one at least!\")\r\n        return\r\n      }\r\n      //  一个小优化，直接发送这个数组，而不是一个一个的提交删除\r\n      request.post(\"http://localhost:8181/user/deleteBatch\",this.ids).then(res =>{\r\n        if(res.code === '0'){\r\n          ElMessage.success(\"Successfully batch delete!\")\r\n          this.load()\r\n        }\r\n        else {\r\n          ElMessage.error(res.msg)\r\n        }\r\n      })\r\n    },\r\n    load(){\r\n      request.get(\"http://localhost:8181/user/usersearch\",{\r\n        params:{\r\n          pageNum: this.currentPage,\r\n          pageSize: this.pageSize,\r\n          search1: this.search1,\r\n          search2: this.search2,\r\n          search3: this.search3,\r\n          search4: this.search4,\r\n        }\r\n      }).then(res =>{\r\n        console.log(res)\r\n        this.tableData = res.data.records\r\n        this.total = res.data.total\r\n      })\r\n    },\r\n    clear(){\r\n      this.search1 = \"\"\r\n      this.search2 = \"\"\r\n      this.search3 = \"\"\r\n      this.load()\r\n    },\r\n\r\n    handleDelete(id){\r\n      request.delete(\"http://localhost:8181/user/\" + id ).then(res =>{\r\n        console.log(res)\r\n        if(res.code == 0 ){\r\n          ElMessage.success(\"Successfully delete!\")\r\n        }\r\n        else\r\n          ElMessage.error(res.msg)\r\n        this.load()\r\n      })\r\n    },\r\n\r\n\r\n    add(){\r\n      this.dialogVisible= true\r\n      this.form ={}\r\n    },\r\n    save(){\r\n      if(this.form.id){\r\n        request.put(\"http://localhost:8181/user\",this.form).then(res =>{\r\n          console.log(res)\r\n          if(res.code == 0){\r\n            ElMessage({\r\n              message: 'Successfully Update!',\r\n              type: 'success',\r\n            })\r\n          }\r\n          else {\r\n            ElMessage.error(res.msg)\r\n          }\r\n\r\n          this.load() //不知道为啥，更新必须要放在这里面\r\n          this.dialogVisible = false\r\n        })\r\n      }\r\n      else {\r\n        request.post(\"http://localhost:8181/user\",this.form).then(res =>{\r\n          console.log(res)\r\n          if(res.code == 0){\r\n            ElMessage.success('Successfully Save!')\r\n          }\r\n          else {\r\n            ElMessage.error(res.msg)\r\n          }\r\n          this.load()\r\n          this.dialogVisible = false\r\n        })\r\n      }\r\n\r\n    },\r\n\r\n\r\n    handleEdit(row){\r\n      this.form = JSON.parse(JSON.stringify(row))\r\n      this.dialogVisible = true\r\n    },\r\n    handleSizeChange(pageSize){\r\n      this.pageSize = pageSize\r\n      this.load()\r\n    },\r\n    handleCurrentChange(pageNum){\r\n      this.pageNum = pageNum\r\n      this.load()\r\n    },\r\n  },\r\n  data() {\r\n    return {\r\n      form: {},\r\n      dialogVisible : false,\r\n      search1:'',\r\n      search2:'',\r\n      search3:'',\r\n      search4:'',\r\n      total:10,\r\n      currentPage:1,\r\n      pageSize: 10,\r\n      tableData: [\r\n\r\n      ],\r\n      user:{},\r\n      ids:[],\r\n    }\r\n  },\r\n}\r\n</script>\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}