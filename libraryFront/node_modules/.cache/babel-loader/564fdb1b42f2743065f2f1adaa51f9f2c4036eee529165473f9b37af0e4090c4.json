{"ast":null,"code":"import { EVENT_CODE, triggerEvent } from '../aria.mjs';\nclass SubMenu {\n  constructor(parent, domNode) {\n    this.parent = parent;\n    this.domNode = domNode;\n    this.subIndex = 0;\n    this.subIndex = 0;\n    this.init();\n  }\n  init() {\n    this.subMenuItems = this.domNode.querySelectorAll(\"li\");\n    this.addListeners();\n  }\n  gotoSubIndex(idx) {\n    if (idx === this.subMenuItems.length) {\n      idx = 0;\n    } else if (idx < 0) {\n      idx = this.subMenuItems.length - 1;\n    }\n    ;\n    this.subMenuItems[idx].focus();\n    this.subIndex = idx;\n  }\n  addListeners() {\n    const parentNode = this.parent.domNode;\n    Array.prototype.forEach.call(this.subMenuItems, el => {\n      el.addEventListener(\"keydown\", event => {\n        let prevDef = false;\n        switch (event.code) {\n          case EVENT_CODE.down:\n            {\n              this.gotoSubIndex(this.subIndex + 1);\n              prevDef = true;\n              break;\n            }\n          case EVENT_CODE.up:\n            {\n              this.gotoSubIndex(this.subIndex - 1);\n              prevDef = true;\n              break;\n            }\n          case EVENT_CODE.tab:\n            {\n              triggerEvent(parentNode, \"mouseleave\");\n              break;\n            }\n          case EVENT_CODE.enter:\n          case EVENT_CODE.space:\n            {\n              prevDef = true;\n              event.currentTarget.click();\n              break;\n            }\n        }\n        if (prevDef) {\n          event.preventDefault();\n          event.stopPropagation();\n        }\n        return false;\n      });\n    });\n  }\n}\nexport { SubMenu as default };","map":{"version":3,"names":["SubMenu","constructor","parent","domNode","subIndex","init","subMenuItems","querySelectorAll","addListeners","gotoSubIndex","idx","length","focus","parentNode","Array","prototype","forEach","call","el","addEventListener","event","prevDef","code","EVENT_CODE","down","up","tab","triggerEvent","enter","space","currentTarget","click","preventDefault","stopPropagation"],"sources":["../../../../../packages/utils/menu/submenu.ts"],"sourcesContent":["import { EVENT_CODE, triggerEvent } from '../aria'\nimport type MenuItem from './menu-item'\n\nclass SubMenu {\n  public subMenuItems: NodeList\n  public subIndex = 0\n  constructor(public parent: MenuItem, public domNode: ParentNode) {\n    this.subIndex = 0\n    this.init()\n  }\n\n  init(): void {\n    this.subMenuItems = this.domNode.querySelectorAll('li')\n    this.addListeners()\n  }\n\n  gotoSubIndex(idx: number): void {\n    if (idx === this.subMenuItems.length) {\n      idx = 0\n    } else if (idx < 0) {\n      idx = this.subMenuItems.length - 1\n    }\n    ;(this.subMenuItems[idx] as HTMLElement).focus()\n    this.subIndex = idx\n  }\n\n  addListeners(): void {\n    const parentNode = this.parent.domNode\n    Array.prototype.forEach.call(this.subMenuItems, (el: Element) => {\n      el.addEventListener('keydown', (event: KeyboardEvent) => {\n        let prevDef = false\n        switch (event.code) {\n          case EVENT_CODE.down: {\n            this.gotoSubIndex(this.subIndex + 1)\n            prevDef = true\n            break\n          }\n          case EVENT_CODE.up: {\n            this.gotoSubIndex(this.subIndex - 1)\n            prevDef = true\n            break\n          }\n          case EVENT_CODE.tab: {\n            triggerEvent(parentNode as HTMLElement, 'mouseleave')\n            break\n          }\n          case EVENT_CODE.enter:\n          case EVENT_CODE.space: {\n            prevDef = true\n            ;(event.currentTarget as HTMLElement).click()\n            break\n          }\n        }\n        if (prevDef) {\n          event.preventDefault()\n          event.stopPropagation()\n        }\n        return false\n      })\n    })\n  }\n}\n\nexport default SubMenu\n"],"mappings":";AAGA,MAAAA,OAAA,CAAc;EAGZC,YAAmBC,MAAA,EAAyBC,OAAA,EAAqB;IAA9C,KAAAD,MAAA,GAAAA,MAAA;IAAyB,KAAAC,OAAA,GAAAA,OAAA;IADrC,KAAAC,QAAA,GAAW;IAEhB,KAAKA,QAAA,GAAW;IAChB,KAAKC,IAAA;EAAA;EAGPA,KAAA,EAAa;IACX,KAAKC,YAAA,GAAe,KAAKH,OAAA,CAAQI,gBAAA,CAAiB;IAClD,KAAKC,YAAA;EAAA;EAGPC,aAAaC,GAAA,EAAmB;IAC9B,IAAIA,GAAA,KAAQ,KAAKJ,YAAA,CAAaK,MAAA,EAAQ;MACpCD,GAAA,GAAM;IAAA,WACGA,GAAA,GAAM,GAAG;MAClBA,GAAA,GAAM,KAAKJ,YAAA,CAAaK,MAAA,GAAS;IAAA;IAEnC;IAAE,KAAKL,YAAA,CAAaI,GAAA,EAAqBE,KAAA;IACzC,KAAKR,QAAA,GAAWM,GAAA;EAAA;EAGlBF,aAAA,EAAqB;IACnB,MAAMK,UAAA,GAAa,KAAKX,MAAA,CAAOC,OAAA;IAC/BW,KAAA,CAAMC,SAAA,CAAUC,OAAA,CAAQC,IAAA,CAAK,KAAKX,YAAA,EAAeY,EAAA,IAAgB;MAC/DA,EAAA,CAAGC,gBAAA,CAAiB,WAAYC,KAAA,IAAyB;QACvD,IAAIC,OAAA,GAAU;QACd,QAAQD,KAAA,CAAME,IAAA;UAAA,KACPC,UAAA,CAAWC,IAAA;YAAM;cACpB,KAAKf,YAAA,CAAa,KAAKL,QAAA,GAAW;cAClCiB,OAAA,GAAU;cACV;YAAA;UAAA,KAEGE,UAAA,CAAWE,EAAA;YAAI;cAClB,KAAKhB,YAAA,CAAa,KAAKL,QAAA,GAAW;cAClCiB,OAAA,GAAU;cACV;YAAA;UAAA,KAEGE,UAAA,CAAWG,GAAA;YAAK;cACnBC,YAAA,CAAad,UAAA,EAA2B;cACxC;YAAA;UAAA,KAEGU,UAAA,CAAWK,KAAA;UAAA,KACXL,UAAA,CAAWM,KAAA;YAAO;cACrBR,OAAA,GAAU;cACRD,KAAA,CAAMU,aAAA,CAA8BC,KAAA;cACtC;YAAA;QAAA;QAGJ,IAAIV,OAAA,EAAS;UACXD,KAAA,CAAMY,cAAA;UACNZ,KAAA,CAAMa,eAAA;QAAA;QAER,OAAO;MAAA;IAAA;EAAA;AAAA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}