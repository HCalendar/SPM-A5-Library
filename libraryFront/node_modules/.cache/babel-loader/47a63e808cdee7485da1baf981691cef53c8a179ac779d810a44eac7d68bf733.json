{"ast":null,"code":"import { ref, reactive, h, Transition, withCtx, withDirectives, createVNode, vShow, createApp, toRefs } from 'vue';\nimport { removeClass } from '../../../utils/dom.mjs';\nfunction createLoadingComponent(options) {\n  let afterLeaveTimer;\n  const afterLeaveFlag = ref(false);\n  const data = reactive({\n    ...options,\n    originalPosition: \"\",\n    originalOverflow: \"\",\n    visible: false\n  });\n  function setText(text) {\n    data.text = text;\n  }\n  function destroySelf() {\n    var _a, _b;\n    const target = data.parent;\n    if (!target.vLoadingAddClassList) {\n      let loadingNumber = target.getAttribute(\"loading-number\");\n      loadingNumber = Number.parseInt(loadingNumber) - 1;\n      if (!loadingNumber) {\n        removeClass(target, \"el-loading-parent--relative\");\n        target.removeAttribute(\"loading-number\");\n      } else {\n        target.setAttribute(\"loading-number\", loadingNumber.toString());\n      }\n      removeClass(target, \"el-loading-parent--hidden\");\n    }\n    (_b = (_a = vm.$el) == null ? void 0 : _a.parentNode) == null ? void 0 : _b.removeChild(vm.$el);\n  }\n  function close() {\n    var _a;\n    if (options.beforeClose && !options.beforeClose()) return;\n    const target = data.parent;\n    target.vLoadingAddClassList = void 0;\n    afterLeaveFlag.value = true;\n    clearTimeout(afterLeaveTimer);\n    afterLeaveTimer = window.setTimeout(() => {\n      if (afterLeaveFlag.value) {\n        afterLeaveFlag.value = false;\n        destroySelf();\n      }\n    }, 400);\n    data.visible = false;\n    (_a = options.closed) == null ? void 0 : _a.call(options);\n  }\n  function handleAfterLeave() {\n    if (!afterLeaveFlag.value) return;\n    afterLeaveFlag.value = false;\n    destroySelf();\n  }\n  const elLoadingComponent = {\n    name: \"ElLoading\",\n    setup() {\n      return () => {\n        const svg = data.spinner || data.svg;\n        const spinner = h(\"svg\", {\n          class: \"circular\",\n          viewBox: data.svgViewBox ? data.svgViewBox : \"25 25 50 50\",\n          ...(svg ? {\n            innerHTML: svg\n          } : {})\n        }, [h(\"circle\", {\n          class: \"path\",\n          cx: \"50\",\n          cy: \"50\",\n          r: \"20\",\n          fill: \"none\"\n        })]);\n        const spinnerText = data.text ? h(\"p\", {\n          class: \"el-loading-text\"\n        }, [data.text]) : void 0;\n        return h(Transition, {\n          name: \"el-loading-fade\",\n          onAfterLeave: handleAfterLeave\n        }, {\n          default: withCtx(() => [withDirectives(createVNode(\"div\", {\n            style: {\n              backgroundColor: data.background || \"\"\n            },\n            class: [\"el-loading-mask\", data.customClass, data.fullscreen ? \"is-fullscreen\" : \"\"]\n          }, [h(\"div\", {\n            class: \"el-loading-spinner\"\n          }, [spinner, spinnerText])]), [[vShow, data.visible]])])\n        });\n      };\n    }\n  };\n  const vm = createApp(elLoadingComponent).mount(document.createElement(\"div\"));\n  return {\n    ...toRefs(data),\n    setText,\n    close,\n    handleAfterLeave,\n    vm,\n    get $el() {\n      return vm.$el;\n    }\n  };\n}\nexport { createLoadingComponent };","map":{"version":3,"names":["options","afterLeaveTimer","afterLeaveFlag","ref","data","reactive","originalPosition","originalOverflow","visible","setText","text","destroySelf","_a","_b","target","parent","vLoadingAddClassList","loadingNumber","getAttribute","Number","parseInt","removeClass","removeAttribute","setAttribute","toString","vm","$el","parentNode","removeChild","close","beforeClose","value","clearTimeout","window","setTimeout","closed","call","handleAfterLeave","elLoadingComponent","name","setup","svg","spinner","h","class","viewBox","svgViewBox","innerHTML","cx","cy","r","fill","spinnerText","Transition","onAfterLeave","default","withCtx","withDirectives","createVNode","style","backgroundColor","background","customClass","fullscreen","vShow","createApp","mount","document","createElement","toRefs"],"sources":["../../../../../../packages/components/loading/src/loading.ts"],"sourcesContent":["import {\n  createApp,\n  h,\n  reactive,\n  ref,\n  createVNode,\n  toRefs,\n  Transition,\n  vShow,\n  withCtx,\n  withDirectives,\n} from 'vue'\nimport { removeClass } from '@element-plus/utils/dom'\n\nimport type { LoadingOptionsResolved } from './types'\n\nexport function createLoadingComponent(options: LoadingOptionsResolved) {\n  let afterLeaveTimer: number\n\n  const afterLeaveFlag = ref(false)\n  const data = reactive({\n    ...options,\n    originalPosition: '',\n    originalOverflow: '',\n    visible: false,\n  })\n\n  function setText(text: string) {\n    data.text = text\n  }\n\n  function destroySelf() {\n    const target = data.parent\n    if (!target.vLoadingAddClassList) {\n      let loadingNumber: number | string | null =\n        target.getAttribute('loading-number')\n      loadingNumber = Number.parseInt(loadingNumber as any) - 1\n      if (!loadingNumber) {\n        removeClass(target, 'el-loading-parent--relative')\n        target.removeAttribute('loading-number')\n      } else {\n        target.setAttribute('loading-number', loadingNumber.toString())\n      }\n      removeClass(target, 'el-loading-parent--hidden')\n    }\n    vm.$el?.parentNode?.removeChild(vm.$el)\n  }\n\n  function close() {\n    if (options.beforeClose && !options.beforeClose()) return\n\n    const target = data.parent\n    target.vLoadingAddClassList = undefined\n    afterLeaveFlag.value = true\n    clearTimeout(afterLeaveTimer)\n\n    afterLeaveTimer = window.setTimeout(() => {\n      if (afterLeaveFlag.value) {\n        afterLeaveFlag.value = false\n        destroySelf()\n      }\n    }, 400)\n    data.visible = false\n\n    options.closed?.()\n  }\n\n  function handleAfterLeave() {\n    if (!afterLeaveFlag.value) return\n    afterLeaveFlag.value = false\n    destroySelf()\n  }\n\n  const elLoadingComponent = {\n    name: 'ElLoading',\n    setup() {\n      return () => {\n        const svg = data.spinner || data.svg\n        const spinner = h(\n          'svg',\n          {\n            class: 'circular',\n            viewBox: data.svgViewBox ? data.svgViewBox : '25 25 50 50',\n            ...(svg ? { innerHTML: svg } : {}),\n          },\n          [\n            h('circle', {\n              class: 'path',\n              cx: '50',\n              cy: '50',\n              r: '20',\n              fill: 'none',\n            }),\n          ]\n        )\n\n        const spinnerText = data.text\n          ? h('p', { class: 'el-loading-text' }, [data.text])\n          : undefined\n\n        return h(\n          Transition,\n          {\n            name: 'el-loading-fade',\n            onAfterLeave: handleAfterLeave,\n          },\n          {\n            default: withCtx(() => [\n              withDirectives(\n                createVNode(\n                  'div',\n                  {\n                    style: {\n                      backgroundColor: data.background || '',\n                    },\n                    class: [\n                      'el-loading-mask',\n                      data.customClass,\n                      data.fullscreen ? 'is-fullscreen' : '',\n                    ],\n                  },\n                  [\n                    h(\n                      'div',\n                      {\n                        class: 'el-loading-spinner',\n                      },\n                      [spinner, spinnerText]\n                    ),\n                  ]\n                ),\n                [[vShow, data.visible]]\n              ),\n            ]),\n          }\n        )\n      }\n    },\n  }\n\n  const vm = createApp(elLoadingComponent).mount(document.createElement('div'))\n\n  return {\n    ...toRefs(data),\n    setText,\n    close,\n    handleAfterLeave,\n    vm,\n    get $el(): HTMLElement {\n      return vm.$el\n    },\n  }\n}\n\nexport type LoadingInstance = ReturnType<typeof createLoadingComponent>\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}