{"ast":null,"code":"import { defineComponent, ref, nextTick, onMounted, provide, reactive, toRefs, watch } from 'vue';\nimport { EVENT_CODE } from '../../../utils/aria.mjs';\nimport { UPDATE_MODEL_EVENT } from '../../../utils/constants.mjs';\nimport '../../../tokens/index.mjs';\nimport '../../../hooks/index.mjs';\nimport { radioGroupProps, radioGroupEmits } from './radio-group.mjs';\nimport { useFormItem } from '../../../hooks/use-form-item/index.mjs';\nimport { radioGroupKey } from '../../../tokens/radio.mjs';\nvar script = defineComponent({\n  name: \"ElRadioGroup\",\n  props: radioGroupProps,\n  emits: radioGroupEmits,\n  setup(props, ctx) {\n    const radioGroupRef = ref();\n    const {\n      formItem\n    } = useFormItem();\n    const changeEvent = value => {\n      ctx.emit(UPDATE_MODEL_EVENT, value);\n      nextTick(() => ctx.emit(\"change\", value));\n    };\n    const handleKeydown = e => {\n      if (!radioGroupRef.value) return;\n      const target = e.target;\n      const className = target.nodeName === \"INPUT\" ? \"[type=radio]\" : \"[role=radio]\";\n      const radios = radioGroupRef.value.querySelectorAll(className);\n      const length = radios.length;\n      const index = Array.from(radios).indexOf(target);\n      const roleRadios = radioGroupRef.value.querySelectorAll(\"[role=radio]\");\n      let nextIndex = null;\n      switch (e.code) {\n        case EVENT_CODE.left:\n        case EVENT_CODE.up:\n          e.stopPropagation();\n          e.preventDefault();\n          nextIndex = index === 0 ? length - 1 : index - 1;\n          break;\n        case EVENT_CODE.right:\n        case EVENT_CODE.down:\n          e.stopPropagation();\n          e.preventDefault();\n          nextIndex = index === length - 1 ? 0 : index + 1;\n          break;\n        default:\n          break;\n      }\n      if (nextIndex === null) return;\n      roleRadios[nextIndex].click();\n      roleRadios[nextIndex].focus();\n    };\n    onMounted(() => {\n      const radios = radioGroupRef.value.querySelectorAll(\"[type=radio]\");\n      const firstLabel = radios[0];\n      if (!Array.from(radios).some(radio => radio.checked) && firstLabel) {\n        firstLabel.tabIndex = 0;\n      }\n    });\n    provide(radioGroupKey, reactive({\n      ...toRefs(props),\n      changeEvent\n    }));\n    watch(() => props.modelValue, () => formItem == null ? void 0 : formItem.validate(\"change\"));\n    return {\n      radioGroupRef,\n      handleKeydown\n    };\n  }\n});\nexport { script as default };","map":{"version":3,"names":["script","defineComponent","name","props","radioGroupProps","emits","radioGroupEmits","setup","ctx","radioGroupRef","ref","formItem","useFormItem","changeEvent","value","emit","UPDATE_MODEL_EVENT","nextTick","handleKeydown","e","target","className","nodeName","radios","querySelectorAll","length","index","Array","from","indexOf","roleRadios","nextIndex","code","EVENT_CODE","left","up","stopPropagation","preventDefault","right","down","click","focus","onMounted","firstLabel","some","radio","checked","tabIndex","provide","radioGroupKey","reactive","toRefs","watch","modelValue","validate"],"sources":["../../../../../../packages/components/radio/src/radio-group.vue"],"sourcesContent":["<template>\n  <div\n    ref=\"radioGroupRef\"\n    class=\"el-radio-group\"\n    role=\"radiogroup\"\n    @keydown=\"handleKeydown\"\n  >\n    <slot></slot>\n  </div>\n</template>\n\n<script lang=\"ts\">\nimport {\n  defineComponent,\n  nextTick,\n  provide,\n  onMounted,\n  ref,\n  reactive,\n  toRefs,\n  watch,\n} from 'vue'\nimport { EVENT_CODE } from '@element-plus/utils/aria'\nimport { UPDATE_MODEL_EVENT } from '@element-plus/utils/constants'\nimport { radioGroupKey } from '@element-plus/tokens'\nimport { useFormItem } from '@element-plus/hooks'\nimport { radioGroupEmits, radioGroupProps } from './radio-group'\nimport type { RadioGroupProps } from '..'\n\nexport default defineComponent({\n  name: 'ElRadioGroup',\n  props: radioGroupProps,\n  emits: radioGroupEmits,\n\n  setup(props, ctx) {\n    const radioGroupRef = ref<HTMLDivElement>()\n    const { formItem } = useFormItem()\n\n    const changeEvent = (value: RadioGroupProps['modelValue']) => {\n      ctx.emit(UPDATE_MODEL_EVENT, value)\n      nextTick(() => ctx.emit('change', value))\n    }\n\n    const handleKeydown = (e: KeyboardEvent) => {\n      if (!radioGroupRef.value) return\n\n      // 左右上下按键 可以在 radio 组内切换不同选项\n      const target = e.target as HTMLInputElement\n      const className =\n        target.nodeName === 'INPUT' ? '[type=radio]' : '[role=radio]'\n      const radios =\n        radioGroupRef.value.querySelectorAll<HTMLInputElement>(className)\n      const length = radios.length\n      const index = Array.from(radios).indexOf(target)\n      const roleRadios =\n        radioGroupRef.value.querySelectorAll<HTMLInputElement>('[role=radio]')\n\n      let nextIndex: number | null = null\n      switch (e.code) {\n        case EVENT_CODE.left:\n        case EVENT_CODE.up:\n          e.stopPropagation()\n          e.preventDefault()\n          nextIndex = index === 0 ? length - 1 : index - 1\n          break\n        case EVENT_CODE.right:\n        case EVENT_CODE.down:\n          e.stopPropagation()\n          e.preventDefault()\n          nextIndex = index === length - 1 ? 0 : index + 1\n          break\n        default:\n          break\n      }\n      if (nextIndex === null) return\n      roleRadios[nextIndex].click()\n      roleRadios[nextIndex].focus()\n    }\n\n    onMounted(() => {\n      const radios =\n        radioGroupRef.value!.querySelectorAll<HTMLInputElement>('[type=radio]')\n      const firstLabel = radios[0]\n      if (!Array.from(radios).some((radio) => radio.checked) && firstLabel) {\n        firstLabel.tabIndex = 0\n      }\n    })\n\n    provide(\n      radioGroupKey,\n      reactive({\n        ...toRefs(props),\n        changeEvent,\n      })\n    )\n\n    watch(\n      () => props.modelValue,\n      () => formItem?.validate('change')\n    )\n\n    return {\n      radioGroupRef,\n      handleKeydown,\n    }\n  },\n})\n</script>\n"],"mappings":";;;;;;;;AA6BA,IAAAA,MAAA,GAAeC,eAAA,CAAgB;EAC7BC,IAAA,EAAM;EACNC,KAAA,EAAOC,eAAA;EACPC,KAAA,EAAOC,eAAA;EAEPC,MAAMJ,KAAA,EAAOK,GAAA,EAAK;IAChB,MAAMC,aAAA,GAAgBC,GAAA;IACtB,MAAM;MAAEC;IAAA,IAAaC,WAAA;IAErB,MAAMC,WAAA,GAAeC,KAAA,IAAyC;MAC5DN,GAAA,CAAIO,IAAA,CAAKC,kBAAA,EAAoBF,KAAA;MAC7BG,QAAA,CAAS,MAAMT,GAAA,CAAIO,IAAA,CAAK,UAAUD,KAAA;IAAA;IAGpC,MAAMI,aAAA,GAAiBC,CAAA,IAAqB;MAC1C,IAAI,CAACV,aAAA,CAAcK,KAAA,EAAO;MAG1B,MAAMM,MAAA,GAASD,CAAA,CAAEC,MAAA;MACjB,MAAMC,SAAA,GACJD,MAAA,CAAOE,QAAA,KAAa,UAAU,iBAAiB;MACjD,MAAMC,MAAA,GACJd,aAAA,CAAcK,KAAA,CAAMU,gBAAA,CAAmCH,SAAA;MACzD,MAAMI,MAAA,GAASF,MAAA,CAAOE,MAAA;MACtB,MAAMC,KAAA,GAAQC,KAAA,CAAMC,IAAA,CAAKL,MAAA,EAAQM,OAAA,CAAQT,MAAA;MACzC,MAAMU,UAAA,GACJrB,aAAA,CAAcK,KAAA,CAAMU,gBAAA,CAAmC;MAEzD,IAAIO,SAAA,GAA2B;MAC/B,QAAQZ,CAAA,CAAEa,IAAA;QAAA,KACHC,UAAA,CAAWC,IAAA;QAAA,KACXD,UAAA,CAAWE,EAAA;UACdhB,CAAA,CAAEiB,eAAA;UACFjB,CAAA,CAAEkB,cAAA;UACFN,SAAA,GAAYL,KAAA,KAAU,IAAID,MAAA,GAAS,IAAIC,KAAA,GAAQ;UAC/C;QAAA,KACGO,UAAA,CAAWK,KAAA;QAAA,KACXL,UAAA,CAAWM,IAAA;UACdpB,CAAA,CAAEiB,eAAA;UACFjB,CAAA,CAAEkB,cAAA;UACFN,SAAA,GAAYL,KAAA,KAAUD,MAAA,GAAS,IAAI,IAAIC,KAAA,GAAQ;UAC/C;QAAA;UAEA;MAAA;MAEJ,IAAIK,SAAA,KAAc,MAAM;MACxBD,UAAA,CAAWC,SAAA,EAAWS,KAAA;MACtBV,UAAA,CAAWC,SAAA,EAAWU,KAAA;IAAA;IAGxBC,SAAA,CAAU,MAAM;MACd,MAAMnB,MAAA,GACJd,aAAA,CAAcK,KAAA,CAAOU,gBAAA,CAAmC;MAC1D,MAAMmB,UAAA,GAAapB,MAAA,CAAO;MAC1B,IAAI,CAACI,KAAA,CAAMC,IAAA,CAAKL,MAAA,EAAQqB,IAAA,CAAMC,KAAA,IAAUA,KAAA,CAAMC,OAAA,KAAYH,UAAA,EAAY;QACpEA,UAAA,CAAWI,QAAA,GAAW;MAAA;IAAA;IAI1BC,OAAA,CACEC,aAAA,EACAC,QAAA,CAAS;MAAA,GACJC,MAAA,CAAOhD,KAAA;MACVU;IAAA;IAIJuC,KAAA,CACE,MAAMjD,KAAA,CAAMkD,UAAA,EACZ,MAAM1C,QAAA,oBAAAA,QAAA,CAAU2C,QAAA,CAAS;IAG3B,OAAO;MACL7C,aAAA;MACAS;IAAA;EAAA;AAAA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}