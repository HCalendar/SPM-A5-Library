{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport { watch } from 'vue';\nimport { isClient, useEventListener } from '@vueuse/core';\nimport { EVENT_CODE } from '../../utils/aria.mjs';\nconst modalStack = [];\nconst closeModal = e => {\n  if (modalStack.length === 0) return;\n  if (e.code === EVENT_CODE.esc) {\n    e.stopPropagation();\n    const topModal = modalStack[modalStack.length - 1];\n    topModal.handleClose();\n  }\n};\nconst useModal = (instance, visibleRef) => {\n  watch(visibleRef, val => {\n    if (val) {\n      modalStack.push(instance);\n    } else {\n      modalStack.splice(modalStack.findIndex(modal => modal === instance), 1);\n    }\n  });\n};\nif (isClient) useEventListener(document, \"keydown\", closeModal);\nexport { useModal };","map":{"version":3,"names":["modalStack","closeModal","e","length","code","EVENT_CODE","esc","stopPropagation","topModal","handleClose","useModal","instance","visibleRef","watch","val","push","splice","findIndex","modal","isClient","useEventListener","document"],"sources":["../../../../../packages/hooks/use-modal/index.ts"],"sourcesContent":["import { watch } from 'vue'\nimport { isClient, useEventListener } from '@vueuse/core'\nimport { EVENT_CODE } from '@element-plus/utils/aria'\n\nimport type { Ref } from 'vue'\n\ntype ModalInstance = {\n  handleClose: () => void\n}\n\nconst modalStack: ModalInstance[] = []\n\nconst closeModal = (e: KeyboardEvent) => {\n  if (modalStack.length === 0) return\n  if (e.code === EVENT_CODE.esc) {\n    e.stopPropagation()\n    const topModal = modalStack[modalStack.length - 1]\n    topModal.handleClose()\n  }\n}\n\nexport const useModal = (instance: ModalInstance, visibleRef: Ref<boolean>) => {\n  watch(visibleRef, (val) => {\n    if (val) {\n      modalStack.push(instance)\n    } else {\n      modalStack.splice(\n        modalStack.findIndex((modal) => modal === instance),\n        1\n      )\n    }\n  })\n}\n\nif (isClient) useEventListener(document, 'keydown', closeModal)\n"],"mappings":";;;;AAUA,MAAMA,UAAA,GAA8B;AAEpC,MAAMC,UAAA,GAAcC,CAAA,IAAqB;EACvC,IAAIF,UAAA,CAAWG,MAAA,KAAW,GAAG;EAC7B,IAAID,CAAA,CAAEE,IAAA,KAASC,UAAA,CAAWC,GAAA,EAAK;IAC7BJ,CAAA,CAAEK,eAAA;IACF,MAAMC,QAAA,GAAWR,UAAA,CAAWA,UAAA,CAAWG,MAAA,GAAS;IAChDK,QAAA,CAASC,WAAA;EAAA;AAAA;MAIAC,QAAA,GAAWA,CAACC,QAAA,EAAyBC,UAAA,KAA6B;EAC7EC,KAAA,CAAMD,UAAA,EAAaE,GAAA,IAAQ;IACzB,IAAIA,GAAA,EAAK;MACPd,UAAA,CAAWe,IAAA,CAAKJ,QAAA;IAAA,OACX;MACLX,UAAA,CAAWgB,MAAA,CACThB,UAAA,CAAWiB,SAAA,CAAWC,KAAA,IAAUA,KAAA,KAAUP,QAAA,GAC1C;IAAA;EAAA;AAAA;AAMR,IAAIQ,QAAA,EAAUC,gBAAA,CAAiBC,QAAA,EAAU,WAAWpB,UAAA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}